\kClass $Lifeboat$ \kISO $SafetyEquipment$
\par
\kInstanceVarDef
\parlinebr
\begin{insvar}
\assdef{id}{Bid}
\end{insvar}
\begin{insvar}
\assdef{acceptingCrew}{\Bool }
\end{insvar}
\begin{insvar}
\assdef{crew}{\setof{Pid}}[{\set{}}]
\end{insvar}
\begin{insvar}
\assdef{areas}{\setof{Aid}}[{\set{}}]
\end{insvar}
\begin{instinvfn}
 \Card crew \Le capacity\end{instinvfn}
\par
\kOperations
\kw{\kw{public}}\begin{op}[e]{Lifeboat}%
\signature{\Nat  \X Bid \Oto Lifeboat}
\parms{cap,bid}
\annlab[o]{Lifeboat`Lifeboat}
\begin{blockstmt}
\ass{acceptingCrew}{\True } ; \\
\ass{capacity}{cap} ; \\
\ass{id}{bid}
\end{blockstmt};
\end{op}
\kw{\kw{public}}\begin{op}[e]{getId}%
\signature{() \Oto Bid}
\parms{}
\annlab[o]{Lifeboat`getId}
\return{id};
\end{op}
\kw{\kw{public}}\begin{op}[e]{getRemainingCap}%
\signature{() \Oto \Nat }
\parms{}
\annlab[o]{Lifeboat`getRemainingCap}
\If acceptingCrew
\Then \\
\return{capacity \Minus  \Card crew}
\Else \\
\return{0}
\Fi;
\end{op}
\kw{\kw{public}}\begin{op}[e]{addPerson}%
\signature{Pid \Oto ()}
\parms{p}
\annlab[o]{Lifeboat`addPerson}
\ass{crew}{crew \Union \set{p}}
\begin{precond}
capacity \Minus  \Card crew > 0 \And acceptingCrew
\end{precond}
\begin{postcond}
p \In crew
\end{postcond};
\end{op}
\kw{\kw{public}}\begin{op}[e]{removePerson}%
\signature{Pid \Oto ()}
\parms{p}
\annlab[o]{Lifeboat`removePerson}
\ass{crew}{crew \Setdiff \set{p}}
\begin{precond}
p \In crew
\end{precond}
\begin{postcond}
p \Notin crew
\end{postcond};
\end{op}
\kw{\kw{public}}\begin{op}[e]{addArea}%
\signature{Aid \Oto ()}
\parms{a}
\annlab[o]{Lifeboat`addArea}
\ass{areas}{areas \Union \set{a}};
\end{op}
\kw{\kw{public}}\begin{op}[e]{removeArea}%
\signature{Aid \Oto ()}
\parms{a}
\annlab[o]{Lifeboat`removeArea}
\ass{areas}{areas \Setdiff \set{a}};
\end{op}
\kw{\kw{public}}\begin{op}[e]{isDedicated}%
\signature{() \Oto \Bool }
\parms{}
\annlab[o]{Lifeboat`isDedicated}
\return{ \Card areas = 1};
\end{op}
\kw{\kw{public}}\begin{op}[e]{getAreas}%
\signature{() \Oto \setof{Aid}}
\parms{}
\annlab[o]{Lifeboat`getAreas}
\return{areas};
\end{op}
\kw{\kw{public}}\begin{op}[e]{disable}%
\signature{() \Oto ()}
\parms{}
\annlab[o]{Lifeboat`disable}
\ass{acceptingCrew}{\False };
\end{op}
\kw{\kw{public}}\begin{op}[e]{enable}%
\signature{() \Oto ()}
\parms{}
\annlab[o]{Lifeboat`enable}
\ass{acceptingCrew}{\True };
\end{op}
\kw{\kw{public}}\begin{op}[e]{getInterCrew}%
\signature{\setof{Pid} \Oto \setof{Pid}}
\parms{ps}
\annlab[o]{Lifeboat`getInterCrew}
\return{crew \Inter ps};
\end{op}
\kw{\kw{public}}\begin{op}[e]{getCrew}%
\signature{() \Oto \setof{Pid}}
\parms{}
\annlab[o]{Lifeboat`getCrew}
\return{crew}
\end{op}
\kSync
\mutex{addPerson};
\mutex{addPerson,removePerson,getRemainingCap,getCrew,getInterCrew};
\mutex{addArea,removeArea,getAreas,isDedicated};
\mutex{disable,enable,getRemainingCap}
\kEnd $Lifeboat$

