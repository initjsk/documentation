RESULT:result:-1:-1,-1:module DEFAULTexports alldefinitionsstate Systemof[accounts'map ((unresolved DEFAULT`AccountId)) to ((unresolved DEFAULT`Account)), illegalCards'set of ((unresolved DEFAULT`CardId)), curCard'[(unresolved DEFAULT`Card)], cardOk'bool, retainedCards'set of ((unresolved DEFAULT`Card))]	inv mk_(unresolved DEFAULT`System)(accs, -, curCard, cardOk, -) == (((curCard = nil) => (not cardOk)) and (forall id1, id2 in set (dom accs) & ((id1 <> id2) => (((dom (accs(id1).cards)) inter (dom (accs(id2).cards))) = {}))))	init s == (s = mk_System({}, {}, nil, false, {}))static private Account = compose Account of cards'map ((unresolved DEFAULT`CardId)) to ((unresolved DEFAULT`Cardholder)), balance'nat, transactions'seq of ((unresolved DEFAULT`Transaction)) end	inv account == TransactionsInvariant((account.transactions))static private Transaction = compose Transaction of date'(unresolved DEFAULT`Date), cardId'(unresolved DEFAULT`CardId), amount'nat endstatic private Card = compose Card of code'(unresolved DEFAULT`Code), cardId'(unresolved DEFAULT`CardId), accountId'(unresolved DEFAULT`AccountId) endstatic private Cardholder = compose Cardholder of name'(unresolved DEFAULT`Name) endstatic private AccountId = natstatic private Name = seq of (char)static private CardId = natstatic private Code = natstatic private PinCode = natstatic private Date = seq of (char)static private TransactionsInvariant' (seq of ((unresolved DEFAULT`Transaction)) +> bool)	TransactionsInvariant(ts) ==(forall date in set {(ts(i).date) | [i in set (inds ts)]} & (DateTotal(date, ts) <= dailyLimit))static private DateTotal' ((unresolved DEFAULT`Date) * seq of ((unresolved DEFAULT`Transaction)) +> nat)	DateTotal(date, ts) ==Sum([(ts(i).amount) | i in set (inds ts) & ((ts(i).date) = date)])static private dailyLimit'nat = 2000InsertCard ((unresolved DEFAULT`Card) ==> ())	InsertCard(c) ==curCard '= c	pre (curCard = nil)Validate ((unresolved DEFAULT`PinCode) ==> (<PinNotOk> | <PinOk> | <Retained>))	Validate(pin) ==let private value codeOk'?private value cardLegal'? in (if (not cardLegal)then(retainedCards '= (retainedCards union {curCard});cardOk '= false;curCard '= nil;return (<Retained>))elsecardOk '= codeOk;return ((if cardOkthen <PinOk>else <PinNotOk>)))	pre ((curCard <> nil) and (not cardOk))ReturnCard (() ==> ())	ReturnCard() ==(cardOk '= false;curCard '= nil)	pre (curCard <> nil)GetBalance (() ==> nat)	GetBalance() ==return ((accounts((curCard.accountId)).balance))	pre ((curCard <> nil) and (cardOk and IsLegalCard(curCard, illegalCards, accounts)))MakeWithdrawal (nat * (unresolved DEFAULT`Date) ==> bool)	MakeWithdrawal(amount, date) ==let private value cardId, accountId'?private value transaction'? in if ((((accounts(accountId).balance) - amount) >= 0) and (DateTotal(date, ((accounts(accountId).transactions) ^ [transaction])) <= dailyLimit))then(accounts(accountId).balance '= ((accounts(accountId).balance) - amount);accounts(accountId).transactions '= ((accounts(accountId).transactions) ^ [transaction]);return (true))elsereturn (false)	pre ((curCard <> nil) and (cardOk and IsLegalCard(curCard, illegalCards, accounts)))RequestStatement (() ==> ((unresolved DEFAULT`Name) * seq of ((unresolved DEFAULT`Transaction)) * nat))	RequestStatement() ==let private value cardId, accountId'?private value cards, balance, transactions'? in return (mk_((cards(cardId).name), transactions, balance))	pre ((curCard <> nil) and (cardOk and IsLegalCard(curCard, illegalCards, accounts)))static private IsLegalCard' ((unresolved DEFAULT`Card) * set of ((unresolved DEFAULT`CardId)) * map ((unresolved DEFAULT`AccountId)) to ((unresolved DEFAULT`Account)) -> bool)	IsLegalCard(mk_(unresolved DEFAULT`Card)(-, cardId, accountId), pillegalcards, paccounts) ==((cardId not in set pillegalcards) and ((accountId in set (dom paccounts)) and (cardId in set (dom (paccounts(accountId).cards)))))ReportIllegalCard ((unresolved DEFAULT`CardId) ==> ())	ReportIllegalCard(cardId) ==illegalCards '= (illegalCards union {cardId})AddAccount ((unresolved DEFAULT`AccountId) * (unresolved DEFAULT`Account) ==> ())	AddAccount(accountId, account) ==accounts '= (accounts munion {accountId |-> account})	pre (accountId not in set (dom accounts))static private Encode' ((unresolved DEFAULT`PinCode) +> (unresolved DEFAULT`Code))	Encode(pin) ==pinstatic private Sum' (seq of (real) +> real)	Sum(rs) ==(if (rs = [])then 0else ((hd rs) + Sum((tl rs))))static private Len' (seq of (real) +> nat)	Len(list) ==(len list)[TestCash] = [[let c in set {mk_Card(1, 1, 1), mk_Card(2, 2, 2)} in [[InsertCard(c)], [Validate(1111)], [ReportIllegalCard((c.cardId))]]{1, 5}]]end DEFAULT
